{% extends "/base.html" %}
{% block css %}
<link href="/static/css/index.css" media="screen" rel="stylesheet" type="text/css"/>
{% endblock %}
{% block content %}
    <div class="container">
    <div class="row">
        <div class="col-lg-12">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <div class="text-muted bootstrap-admin-box-title">信息列表</div>
                </div>
                <div class="bootstrap-admin-panel-content">
                    <div id="example_wrapper" class="dataTables_wrapper form-inline" role="grid">
                        <table class="table table-striped table-bordered dataTable" id="example"
                               aria-describedby="example_info">
                            <thead>
                            <tr role="row">
                                <th class="sorting_asc" role="columnheader" tabindex="0" aria-controls="example"
                                    rowspan="1" colspan="1" aria-sort="ascending"
                                    style="width: 157px;">温度
                                </th>
                                <th class="sorting_desc" role="columnheader" tabindex="0" aria-controls="example"
                                    rowspan="1" colspan="1"
                                    style="width: 94px;">湿度
                                </th>
                                <th class="sorting" role="columnheader" tabindex="0" aria-controls="example" rowspan="1"
                                    colspan="1"
                                    style="width: 94px;">甲醛
                                </th>
                                <th class="sorting" role="columnheader" tabindex="0" aria-controls="example" rowspan="1"
                                    colspan="1"
                                    style="width: 94px;">主题
                                </th>
                               <th class="sorting" role="columnheader" tabindex="0" aria-controls="example" rowspan="1"
                                    colspan="1" aria-label="Engine version: activate to sort column ascending"
                                    style="width: 133px;">时间
                                </th>
                            </tr>
                            </thead>
                            <tr class="gradeA ${status.index%2==0?'odd':'even'}">
                                    <td class=" sorting_1"><input type="text" id="temperature" name="temperature" ></td>
                                    <td class="fullname"><input type="text" id="hcho_concentrer" name="hcho_concentrer" ></td>
                                    <td><input type="text" id="rh" name="rh" ></td>
                                    <td class="center"><input type="text" id="topic_name" name="topic_name" ></td>
                                    <td><input type="text" id="create_time" name="create_time" ></td>
                                </tr>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
{% block bodyscript %}
     <script type="text/javascript" src="/static/js/bootstrap.min.js"></script>
    <script>
        function test() {
            $.ajax(
                {
                    url:'{{ url_for('NewMqttDtaView') }}',
                    type:'post',
                    data:"",
                    success: function (data) {
                        if(data.success =="ok"){
                            $("#temperature").attr("value",data["ret"]['temperature']);
                            $("#hcho_concentrer").attr("value",data["ret"]['hcho_concentrer']);
                            $("#rh").attr("value",data["ret"]['rh']);
                            $("#topic_name").attr("value",data["ret"]['topic_name']);
                            $("#create_time").attr("value",data["ret"]['create_time']);
                        }
                    }
                }
        )
        }
        setInterval("test()",1000);

//        var xmlHttp;
//        window.onload = function () {
//            doStart();
//        }
//        function createXMLHttpRequest() {
//            if(window.ActiveXObject){
//                xmlHttp = new ActiveXObject("Microsoft.XMLHTTP");
//            }
//            else if(window.XMLHttpRequest)(
//                    xmlHttp = new XMLHttpRequest();
//            )
//        }
//        function doStart() {
//            createXMLHttpRequest();
//            var url = '{{ url_for('NewMqttDtaView') }}';
//            xmlHttp.open("GET",url,true);
//            xmlHttp.onreadystatechange = startcallback;
//            xmlHttp.send(null);
//
//        }
//        function startcallback() {
//            if (xmlHttp.readyState==4){
//                if(xmlHttp.status==200){
//                    setTimeout("pollServer()",5000);
//                    refreshTime();
//                }
//                else{
//                    alert(xmlHttp.status);
//                }
//            }
//        }
//        function pollServer() {
//             createXMLHttpRequest();
//            var url = '{{ url_for('NewMqttDtaView') }}';
//            xmlHttp.open("GET",url,true);
//            xmlHttp.onreadystatechange = pollcallback;
//            xmlHttp.send(null);
//        }
//        function pollcallback() {
//            if (xmlHttp.readyState==4){
//                if(xmlHttp.status==200){
//                    var message = xmlHttp.responseXML.getElementsByTagName()
//                }
//                else{
//                    alert(xmlHttp.status);
//                }
//            }
//        }

    </script>
{% endblock %}